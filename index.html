<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8" />
  <title>Pola Makan Sehat</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <style>
    * { box-sizing: border-box; margin:0; padding:0 }
    body {
      font-family: 'Segoe UI', sans-serif;
      background: #f0fff8;
      color: #333;
    }
    .container {
      max-width: 480px;
      margin: 60px auto;
      padding: 24px;
      background: #fff;
      border-radius: 12px;
      box-shadow: 0 4px 20px rgba(0,0,0,0.05);
    }
    .header-logo {
      text-align: center;
      margin-bottom: 16px;
    }
    .header-logo img {
      width: 80px;
      border-radius: 8px;
    }
    h1, h2 {
      text-align: center;
      color: #2a7955;
      margin-bottom: 16px;
    }
    h1 { font-size: 1.8em }
    h2 { font-size: 1.3em }
    section { display: none }
    section.active { display: block }

    .question-text {
      font-weight: 600;
      color: #2a7955;
      margin-bottom: 12px;
      font-size: 1.05em;
    }
    textarea {
      width: 100%;
      height: 80px;
      padding: 10px;
      border: 1px solid #cdefe1;
      border-radius: 8px;
      resize: vertical;
      font-size: 1em;
      margin-bottom: 16px;
    }
    .btn-next {
      width: 100%;
      padding: 12px;
      background: linear-gradient(90deg, #2a7955, #5fb58c);
      color: #fff;
      border: none;
      border-radius: 8px;
      font-size: 1em;
      cursor: pointer;
    }
    .btn-next:hover {
      background: linear-gradient(90deg, #236643, #4fa27f);
    }
    .project-credit {
      text-align: center;
      font-size: 0.85em;
      color: #666;
      margin-top: 24px;
    }
    #aiOverview {
      min-height: 80px;
      padding: 12px;
      border: 1px solid #cdefe1;
      border-radius: 8px;
      background: #f0fff8;
      font-size: 0.95em;
      line-height: 1.4;
    }
  </style>
</head>

<body>
  <div class="container">
    <div class="header-logo">
      <img src="https://yt3.ggpht.com/a/AATXAJwRp9NDxa9WX7nh8uuO9TUCUCMqCRE5yJp4CQ=s900-c-k-c0xffffffff-no-rj-mo"
           alt="Logo Sekolah Al Ikhlas">
    </div>
    <h1>Pola Makan Sehat</h1>

    <!-- STEP 1: SURVEY -->
    <section id="survey" class="active">
      <div class="question-text" id="question"></div>
      <textarea id="answer" placeholder="Tuliskan jawaban..."></textarea>
      <button id="nextBtn" class="btn-next">Next</button>
      <div class="project-credit">Karya Kelompok 1 — Proyek 1</div>
    </section>

    <!-- STEP 2: AI OVERVIEW -->
    <section id="overview">
      <h2>Overview AI</h2>
      <div id="aiOverview"></div>
      <button id="overviewNext" class="btn-next">Next</button>
    </section>
  </div>

  <script>
  document.addEventListener("DOMContentLoaded", () => {
    const questions = [
      "1. Menurut kamu makanan junk food sehat atau tidak?",
      "2. Seberapa sering kamu mengonsumsi junk food?",
      "3. Berapa kali kamu makan dalam sehari?",
      "4. Apakah kamu sering mengonsumsi soda atau minuman berwarna?",
      "5. Apakah kamu sering mengonsumsi sayur-sayuran?",
      "6. Sebutkan satu makanan bergizi dan satu yang tidak bergizi.",
      "7. Menurut kamu, seberapa penting nutrisi seimbang?",
      "8. Buah atau sayur mana yang paling sering kamu konsumsi?",
      "9. Apa tantanganmu untuk makan lebih sehat?",
      "10. Langkah apa yang akan kamu ambil untuk pola makan lebih baik?"
    ];
    let idx = 0, answers = [];

    const survey    = document.getElementById("survey");
    const overview  = document.getElementById("overview");
    const questionP = document.getElementById("question");
    const answerTa  = document.getElementById("answer");
    const nextBtn   = document.getElementById("nextBtn");
    const aiDiv     = document.getElementById("aiOverview");
    const ovNext    = document.getElementById("overviewNext");

    function showQuestion(i) {
      questionP.textContent = questions[i];
      answerTa.value = "";
      nextBtn.textContent = i < questions.length - 1 ? "Next" : "Submit";
    }

    nextBtn.addEventListener("click", async () => {
      const val = answerTa.value.trim();
      if (!val) {
        alert("Mohon isi jawaban terlebih dahulu.");
        return;
      }
      answers[idx] = val;

      if (idx < questions.length - 1) {
        idx++;
        showQuestion(idx);
      } else {
        // Move to AI overview
        survey.classList.remove("active");
        overview.classList.add("active");

        aiDiv.textContent = "Memuat overview AI…";
        const prompt = answers
          .map((a, i) => `${questions[i]}\nJawaban: ${a}`)
          .join("\n\n");

        try {
          const res = await fetch(
            `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash:generateContent?key=AIzaSyDIVFI3M-283v1Ume5ivh3iHnByP_RAxh0`,
            {
              method: "POST",
              headers: { "Content-Type": "application/json" },
              body: JSON.stringify({
                contents: [
                  { parts: [{ text: `Ringkas pola makan:\n\n${prompt}` }] }
                ]
              })
            }
          );
          const json = await res.json();
          const text =
            json.candidates?.[0]?.content?.parts?.[0]?.text ||
            "AI gagal menghasilkan overview.";
          aiDiv.innerHTML = text.replace(/\n/g, "<br>");
        } catch (e) {
          aiDiv.innerHTML =
            "<span style='color:red'>Error memuat AI overview.</span>";
        }
      }
    });

    // Placeholder for moving past overview
    ovNext.addEventListener("click", () => {
      alert("Lanjut ke langkah berikutnya...");
    });

    showQuestion(idx);
  });
  </script>
</body>
</html>
